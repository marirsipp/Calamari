function [OutputFcMmt] = Dalet_Frame_LMBmid_PtFc(alpha,beta)%Input - constantsrho_w = 1025; %kg/m^3, sea water mass densityrho_s = 7850; %kg/m^3, steel mass densityg = 9.81;E = 200e9; %Pa, Young's modulus%Input - geometryro_LMB = 1.1; %m, outer radius of LMBthk_LMB = 0.025; %m, thickness of LMBL_LMB = 52.7; %m, length of LMBro_Col = 2.25; %m, outer radius of Col2thk_Col = 0.038; %m, thickness of Col2L_Col = 29; %m, height of Col2EL_wl = 18; %m, draft (elevation of mean free surface level)EL_cnnt = 1.9; %ELevation of LMB to Col connection%--------------------------------------------------------------------------%Calculated geometry parametersA1 = pi*(ro_LMB^2 - (ro_LMB-thk_LMB)^2);I1 = pi/4*(ro_LMB^4 - (ro_LMB-thk_LMB)^4);EA1 = E*A1;EI1 = E*I1;A2 = pi*(ro_Col^2 - (ro_Col-thk_Col)^2);I2 = pi/4*(ro_Col^4 - (ro_Col-thk_Col)^4);EA2 = E*A2;EI2 = E*I2;%Calculated loading parameters%Distributed loads on LMBb1 = rho_w*g*pi*ro_LMB^2;m1 = rho_s*g*A1;%Distributed loads on Colm2 = rho_s*g*A2;%Point force on LMB*Col connection, due to hydrostatic pressure % PtFc1 = rho_w*g*(EL_wl-EL_cnnt)*pi*ro_LMB^2;PtFc1 = 1e6;%Point force at the mid point of LMB, positive upwardsPtFc2 = b1*L_LMB;a = L_LMB/2;%--------------------------------------------------------------------------%Load case 1 - in water% CaseName = 'Model1';% FileName = [path0 '\Analytical_' CaseName '.xls'];% L1 = L_LMB;% L2 = L_Col;% l1 = EL_cnnt;% F1 = PtFc1; %positive pointing from LMB*Col connection towards LMB fix end% F2 = 0; %positive upwards% f1 = b1 - m1; %positive upwards% f2 = m2; %positive downward%Load case 2 - out of water% CaseName = 'Dry_Alpha_neg1';% FileName = [path0 '\Analytical_' CaseName '.xls'];% alpha = -1;L1 = L_LMB;L2 = L_Col;l1 = EL_cnnt;F1 = beta*PtFc1; %positive pointing from LMB*Col connection towards LMB fix endF2 = alpha*PtFc2; %positive upwardsf1 = - m1; %positive upwardsf2 = m2; %positive downward%--------------------------------------------------------------------------%Dalet frame fix end - from linear superposistionpar_H_1 = 0;par_V_1 = L1^3/3/EI1 + l1/EA2;par_M_1 = L1^2/2/EI1;const_1 = -f1*L1^4/8/EI1 + 1/EA2*(0.5*f2*l1^2 - f2*L2*l1) - F2*a^2/6/EI1*(3*L1-a);par_H_2 = L1/EA1 + l1^3/3/EI2;par_V_2 = 0;par_M_2 = -l1^2/2/EI2;const_2 = -F1*l1^3/3/EI2;par_H_3 = l1^2/2/EI2;par_V_3 = -L1^2/2/EI1;par_M_3 = -l1/EI2 - L1/EI1;const_3 = f1*L1^3/6/EI1 - F1*l1^2/2/EI2 + F2*a^2/2/EI1;par = [par_H_1,par_V_1,par_M_1;par_H_2,par_V_2,par_M_2;par_H_3,par_V_3,par_M_3];const = [const_1;const_2;const_3];Fr = par\const;H = Fr(1);V = Fr(2);M = Fr(3);%--------------------------------------------------------------------------%%%LMB resultsz1 = 0:0.1:a;u1_1 = f1*z1.^2/24/EI1.*(6*L1^2-4*L1*z1+z1.^2);u1_2 = V*z1.^2/6/EI1.*(3*L1-z1);u1_3 = M*z1.^2/2/EI1;u1_4 = F2*z1.^2/6/EI1.*(3*a-z1);u1 = u1_1+u1_2+u1_3+u1_4;Vx1 = f1*(L1-z1) + V+F2;My1 = 0.5*f1*(L1-z1).^2 + V*(L1-z1) + M + F2*(a-z1);z2 = a:0.1:L_LMB;u2_1 = f1*z2.^2/24/EI1.*(6*L1^2-4*L1*z2+z2.^2);u2_2 = V*z2.^2/6/EI1.*(3*L1-z2);u2_3 = M*z2.^2/2/EI1;u2_4 = F2*a^2/6/EI1.*(3*z2-a);u2 = u2_1+u2_2+u2_3+u2_4;Vx2 = f1*(L1-z2)+V;My2 = 0.5*f1*(L1-z2).^2 + V*(L1-z2) + M;z_LMB = [z1,z2];u_LMB = [u1,u2];w_LMB = H*z_LMB/EA1;P_LMB = H*ones(size(z_LMB));Vx_LMB = [Vx1,Vx2];My_LMB = [My1,My2];%transfer to SAP coordinate systemY_LMB = L_LMB - z_LMB;P1_LMB = P_LMB;V2_LMB = -Vx_LMB;V3_LMB = zeros(size(Y_LMB));M2_LMB = zeros(size(Y_LMB));M3_LMB = My_LMB;U2_LMB = -w_LMB;U3_LMB = u_LMB;%OutputMy_LMBmid = My1(end);OutputFcMmt = [H,My_LMBmid];% Rst_LMB = [z_LMB',u_LMB', w_LMB', P_LMB', Vx_LMB', My_LMB', Y_LMB', U2_LMB', U3_LMB', P1_LMB', V2_LMB', V3_LMB', M2_LMB', M3_LMB'];% Header1_LMB = [{'Local_z'},{'Local_u'},{'Local_w'},{'P'}, {'Vx'}, {'My'}, {'SAP_y'}, {'SAP_U2'}, {'SAP_U3'}, {'SAP_P'}, {'SAP_V2'}, {'SAP_V3'}, {'SAP_M2'}, {'SAP_M3'}];% Header2_LMB = [{'m'},{'m'},{'m'},{'N'}, {'N'}, {'N-m'}, {'m'}, {'m'}, {'m'}, {'N'}, {'N'}, {'N'}, {'N-m'}, {'N-m'}];% % LMB_analy_rst = [Header1_LMB;Header2_LMB; num2cell(Rst_LMB)];% xlswrite(FileName,LMB_analy_rst,'LMB')%--------------------------------------------------------------------------%%%Column results%x<l1x1 = 0:0.1:l1;u1_1 = 1/EA2*(0.5*f2*x1.^2-f2*L2*x1);u1_2 = -V*x1/EA2;u1 = u1_1+u1_2;w1_1 = -(F1+H)*x1.^2/6/EI2 .* (3*l1 - x1); w1_2 = M.*x1.^2/2/EI2;w1 = w1_1+w1_2;P1 = f2*x1 - f2*L2 - V;Vz1 = -(F1+H)*ones(size(x1));My1 = -(F1+H)*(l1-x1)+M;x2 = [l1:0.1:4, 4:1:L2];u2_1 = 1/EA2*(0.5*f2*x2.^2-f2*L2*x2);u2_2 = -V*l1/EA2*ones(size(x2));u2 = u2_1+u2_2;w2_1 = -(F1+H)*l1^2/6/EI2 .* (3*x2 - l1); w2_2 = M.*l1/2/EI2 * (2*x2-l1);w2 = w2_1+w2_2;P2 = f2*x2 - f2*L2;Vz2 = zeros(size(x2));My2 = zeros(size(x2));x_Col = [x1,x2];u_Col = [u1,u2];w_Col = [w1,w2];P_Col = [P1,P2];Vz_Col = [Vz1,Vz2];My_Col = [My1,My2];%transfer to SAP coordinate systemZ_Col = x_Col;U2_Col = -w_Col;U3_Col = u_Col;P2_Col = P_Col;V2_Col = zeros(size(Z_Col));V3_Col = -Vz_Col;M2_Col = -My_Col;M3_Col = zeros(size(Z_Col));% Rst_Col = [x_Col',u_Col', w_Col', P_Col', Vz_Col', My_Col', Z_Col', U2_Col', U3_Col', P2_Col', V2_Col', V3_Col', M2_Col', M3_Col'];% Header1_Col = [{'Local_x'},{'Local_u'},{'Local_w'},{'P'}, {'Vz'}, {'My'}, {'SAP_z'}, {'SAP_U2'}, {'SAP_U3'}, {'SAP_P'}, {'SAP_V2'}, {'SAP_V3'}, {'SAP_M2'}, {'SAP_M3'}];% Header2_Col = [{'m'},{'m'},{'m'},{'N'}, {'N'}, {'N-m'}, {'m'}, {'m'}, {'m'}, {'N'}, {'N'}, {'N'}, {'N-m'}, {'N-m'}];% Col_analy_rst = [Header1_Col;Header2_Col; num2cell(Rst_Col)];% xlswrite(FileName,Col_analy_rst,'Col')end